upstream kubeshark-front {
	server kubeshark-front:80;
}

upstream kubeshark-hub {
	server kubeshark-hub:80;
}

server {
	listen      443 ssl http2;
	listen [::]:443 ssl http2;

	server_name ${CLUSTER_HOST}-ks.uws.talkingpts.org;

	root /var/www/html;
	index index.html;

	include snippets/uws.conf;
	include snippets/uwslog-json-analytics.conf;
	include snippets/uwsca-ops.conf;
	include snippets/uwsgd-tls.conf;

	set $upstream_name "kubeshark-front";

	location / {
		include snippets/proxy_params;
		proxy_pass http://kubeshark-front;
	}
}

server {
	listen      80 http2;
	listen [::]:80 http2;

	server_name ${CLUSTER_HOST}-ks.uws.talkingpts.org;

	root /var/www/html;
	index index.html;

	include snippets/uwslog-json-analytics.conf;

	set $upstream_name "kubeshark-hub";

	location / {
		include snippets/proxy_websocket_params;
		proxy_pass http://kubeshark-hub;
	}
}
