#
# internal HTTP server
#	serve public files
#	redirect to main HTTPS domain anything else
#
server {
	listen 80;
	listen [::]:80;

	server_name janis.uws.talkingpts.org;
	server_tokens off;

	root /var/www/html;

	location /.well-known/acme-challenge/ {
		alias /srv/acme/challenges/;
		try_files $uri =404;
	}

#	location /public/ {
#		alias /srv/www/public/;
#		try_files $uri =404;
#	}

#	location / {
#		return 301 https://janis.uws.talkingpts.org$request_uri;
#	}
}

#
# SSL internal domain
#
#~ server {
	#~ listen 443 ssl;
	#~ listen [::]:443 ssl;

	#~ server_name janis.uws.talkingpts.org;
	#~ server_tokens off;

	#~ ssl_certificate /srv/acme/cert/janis.uws.talkingpts.org.crt;
	#~ ssl_certificate_key /srv/acme/key/janis.uws.talkingpts.org.key;

	#~ ssl_session_cache shared:SSL:5m;
	#~ ssl_session_timeout 5m;
	#~ keepalive_timeout 75s;

	#~ ssl_client_certificate /srv/etc/ssl/ca-cert.pem;
	#~ ssl_crl /srv/etc/ssl/ca-crl.pem;
	#~ ssl_verify_client on;

	#~ access_log /var/log/nginx/internal_access.log ssluser;
	#~ error_log /var/log/nginx/internal_error.log;

	#~ location = / {
		#~ return 301 https://janis.uws.talkingpts.org$request_uri;
	#~ }
#~ }
