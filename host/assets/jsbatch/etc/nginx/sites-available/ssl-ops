#
# SSL internal domain
#
include /srv/etc/nginx/uws-cache-setup.conf;
server {
	listen 443 ssl;
	listen [::]:443 ssl;

	server_name ops.uws.talkingpts.org;
	server_tokens off;

	root /srv/www/ssl;

	ssl_certificate /srv/acme/cert/ops.uws.talkingpts.org.crt;
	ssl_certificate_key /srv/acme/key/ops.uws.talkingpts.org.key;

	include /srv/etc/nginx/ssl.conf;

	access_log /var/log/nginx/ops_access.log ssluser;
	error_log /var/log/nginx/ops_error.log;

	include /srv/etc/nginx/ssl-verify-client.conf;

	location /munin/ {
		include /srv/etc/nginx/uws-cache.conf;
		proxy_pass http://127.0.0.1:8049/munin/;
		include /etc/nginx/proxy_params;
	}

	location /munin-cgi/ {
		include /srv/etc/nginx/uws-cache.conf;
		proxy_pass http://127.0.0.1:8049/munin-cgi/;
		include /etc/nginx/proxy_params;
	}

	location /abench/ {
		include /srv/etc/nginx/uws-cache.conf;
		proxy_pass http://127.0.0.1:2742/abench/;
		include /etc/nginx/proxy_params;
	}

	location /htmlcov/ {
		autoindex on;
	}
}
